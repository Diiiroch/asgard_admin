<!DOCTYPE html>
<html>
<head>
    <title>Update Event</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>

<div class="container mt-5">
    <form id="update-event-form">
        <input type="hidden" id="event-id" name="id">
        
        <div class="mb-3">
            <label for="duration" class="form-label">Durée</label>
            <select class="form-control" id="duration" name="duration">
                <option value="1">1</option>
                <option value="0.5">0.5</option>
                <option value="0.25">0.25</option>
            </select>
        </div>
        
        <div class="mb-3">
            <label for="codeprojet" class="form-label">Code Projet</label>
            <select class="form-control" id="codeprojet" name="codeprojet">
                {% for projet in projets %}
                <option value="{{ projet.id }}">{{ projet.intitule }}</option>
                {% endfor %}
            </select>
        </div>
        
        <button type="submit" class="btn btn-primary">Update Event</button>
    </form>
</div>

<script>
$(document).ready(function() {
    $('#update-event-form').submit(function(event) {
        event.preventDefault(); // Empêcher le formulaire de soumettre normalement

        var formData = $(this).serialize(); // Récupérer les données du formulaire

        $.ajax({
            url: '/cra/update_event/', // L'URL doit être correctement définie dans vos URLs Django
            type: "POST",
            data: formData,
            success: function(response) {
                alert(response.success);
                $('#update-event-modal').modal('hide'); // Masquer le modal après la mise à jour
                $('#calendar').fullCalendar('refetchEvents'); // Rafraîchir le calendrier
            },
            error: function(xhr, status, error) {
                alert("Erreur lors de la mise à jour de l'événement : " + error);
            }
        });
    });
});
</script>

</body>
</html>
